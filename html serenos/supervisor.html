<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Dashboard de Supervisores</title>

    <!-- CSS -->
    <link rel="stylesheet" href="../css serenos/supervisor.css" />

    <!-- Librerías -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

    <!-- Leaflet (OpenStreetMap) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>

<body>

<!-- HEADER -->
<header class="top-header">
    <button onclick="window.location.href='../index.html'" class="btn-regresar">
        ⬅ Regresar
    </button>

    <div class="titulo">COMPORTAMIENTO DE SUPERVISORES</div>

    <div class="controls">
        <label style="color:white;font-weight:bold;">Mes:</label>
        <select id="selectMes"></select>

        <button class="btn-export" id="btnPng">Exportar PNG</button>
        <button class="btn-export" id="btnPdf">Exportar PDF</button>
    </div>
</header>

<!-- CONTENIDO -->
<div class="contenedor">

    <!-- 1️⃣ Ranking Supervisores -->
    <div class="card half">
        <h2>Ranking Supervisores</h2>
        <div class="chart-box">
            <canvas id="chartRanking"></canvas>
        </div>
    </div>

    <!-- 2️⃣ Ranking Cargos -->
    <div class="card half">
        <h2>Ranking de Cargos más Escaneados</h2>
        <div class="chart-box">
            <canvas id="chartCargos"></canvas>
        </div>
    </div>

    <!-- 3️⃣ Sector x Supervisor -->
    <div class="card full">
        <h2>Detalle de Escaneos por Sector</h2>
        <div id="sectorTableContainer"></div>
    </div>

    <!-- 4️⃣ Evolución diaria -->
    <div class="card full">
        <h2>Evolución diaria por Supervisor</h2>

        <div style="padding-bottom:5px; font-size:.85rem;">
            <label>Supervisor:</label>
            <select id="supervisorSelect"></select>
        </div>

        <div class="chart-box">
            <canvas id="chartEvolucion"></canvas>
        </div>
    </div>

    <!-- 5️⃣ MAPA - Comportamiento de escaneos -->
    <div class="card full">
        <h2>Comportamiento de escaneos</h2>

        <div class="map-controls">

            <div class="mc-item">
                <label>Supervisor</label>
                <select id="mapSupervisorSelect">
                    <option value="">Seleccione supervisor</option>
                </select>
            </div>

            <div class="mc-item">
                <label>Tiempo</label>
                <select id="mapTipoTiempo">
                    <option value="">Seleccione</option>
                    <option value="MES">Mes</option>
                    <option value="DIA">Día</option>
                </select>
            </div>

            <div class="mc-item" id="mapMesBox" style="display:none;">
                <label>Mes</label>
                <select id="mapMesSelect">
                    <option value="">Seleccione mes</option>
                </select>
            </div>

            <div class="mc-item" id="mapDiaBox" style="display:none;">
                <label>Día</label>
                <input type="date" id="mapDiaInput" />
            </div>

        </div>
        <div class="map-box">

        <!-- INFO FLOTANTE DENTRO DEL MAPA -->
        <div id="mapInfoBox" class="map-info-box">
            <b>Total:</b> 0<br>
            Sector 01: 0<br>
            Sector 02: 0<br>
            Sector 03: 0<br>
            Sector 04: 0<br>
            Sector 05: 0<br>
            FZ: 0
        </div>

        <!-- MAPA -->
        <div id="mapScaneos" style="width:100%; height:100%;"></div>

    </div>



    </div>

</div>

<!-- LOADING EXPORT -->
<div id="exportLoading">Exportando...</div>

<!-- JS -->
<script src="../js-serenos/supervisor.js"></script>

</body>
</html>
